!function(t){function e(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,e),o.l=!0,o.exports}var n={};e.m=t,e.c=n,e.d=function(t,n,r){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:r})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=648)}({368:function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();Object.defineProperty(e,"__esModule",{value:!0});var l=n(390),c=function(t){function e(){return r(this,e),o(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return i(e,t),a(e,[{key:"alert",value:function(t){window.alert(t)}},{key:"setLoadingState",value:function(t){}}]),e}(l.default);e.default=c},390:function(t,e,n){"use strict";function r(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=function(){function t(t,e){var n=[],r=!0,o=!1,i=void 0;try{for(var a,l=t[Symbol.iterator]();!(r=(a=l.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{!r&&l.return&&l.return()}finally{if(o)throw i}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),l=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&(n[r[o]]=t[r[o]]);return n};Object.defineProperty(e,"__esModule",{value:!0});var c;!function(t){t.ADD_REFERENCE="ADD_REFERENCE",t.AVAILABLE="EDITOR_AVAILABLE",t.CITATION_DELETED="CITATION_DELETED",t.TOGGLE_PINNED="TOGGLE_PINNED",t.UNAVAILABLE="EDITOR_UNAVAILABLE",t.UNDO="UNDO"}(c||(c={}));var s=function(){function t(){o(this,t)}return a(t,null,[{key:"createBibliographyElement",value:function(e,n){var o,i=e.heading,a=void 0===i?"":i,l=e.headingLevel,c=void 0===l?"h3":l,s=e.style,u=void 0===s?"fixed":s,d=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],f=document.createElement("div");if(f.id=t.bibliographyId,f.setAttribute("data-reflist",JSON.stringify(n.map(function(t){return t.id}))),(o=f.classList).add.apply(o,[t.bibliographyId].concat(r(d))),f.classList.contains(t.staticBibClass)&&(f.classList.remove(t.bibliographyId),f.removeAttribute("id"),0===n.length)){var h=top.ABT.i18n.errors.warnings;return f.innerHTML="<strong>"+h.warning+":</strong> "+h.noBib+".",f}if(a){var y=void 0;"toggle"===u?(y=document.createElement("button"),y.classList.add(t.bibliographyId+"__heading",t.bibliographyId+"__heading_toggle"),y.setAttribute("aria-expanded","false"),y.setAttribute("aria-controls",this.bibliographyId+"__container"),y.setAttribute("data-heading-level",c)):(y=document.createElement(c),y.classList.add(t.bibliographyId+"__heading")),y.textContent=a,f.appendChild(y)}var v=document.createElement("div");v.id=this.bibliographyId+"__container",v.classList.add(this.bibliographyId+"__container"),f.appendChild(v);var p=!0,b=!1,m=void 0;try{for(var g,E=n[Symbol.iterator]();!(p=(g=E.next()).done);p=!0){var C=g.value,w=document.createElement("div");w.id=C.id,w.innerHTML=C.html,v.appendChild(w)}}catch(t){b=!0,m=t}finally{try{!p&&E.return&&E.return()}finally{if(b)throw m}}return f}},{key:"createFootnoteSection",value:function(e){var n,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],a=document.createElement("div");a.id=t.footnoteId,(n=a.classList).add.apply(n,[t.footnoteId].concat(r(o)));var l=document.createElement("div");l.classList.add(t.footnoteId+"__heading"),l.textContent=top.ABT.i18n.misc.footnotes,a.appendChild(l);var c=!0,s=!1,u=void 0;try{for(var d,f=Array.from(e.entries())[Symbol.iterator]();!(c=(d=f.next()).done);c=!0){var h=d.value,y=i(h,2),v=y[0],p=y[1],b=document.createElement("div");b.classList.add(t.footnoteId+"__item");var m=document.createElement("span");m.classList.add(t.footnoteId+"__number"),m.textContent="["+(v+1)+"]";var g=document.createElement("span");g.classList.add(t.footnoteId+"__content"),g.innerHTML=p,b.appendChild(m),b.appendChild(g),a.appendChild(b)}}catch(t){s=!0,u=t}finally{try{!c&&f.return&&f.return()}finally{if(s)throw u}}return a}},{key:"createInlineElement",value:function(e){var n,o=e.classNames,i=void 0===o?[]:o,a=l(e,["classNames"]),c=a.id,s=a.innerHTML,u=a.reflist,d=document.createElement("span");return d.id=c,(n=d.classList).add.apply(n,[t.citationClass].concat(r(i))),d.innerHTML=s,d.setAttribute("data-reflist",u),"note"===a.kind&&d.setAttribute("data-footnote",a.footnote),d}}]),t}();s.events=c,s.bibliographyId="abt-bibliography",s.citationClass="abt-citation",s.footnoteId="abt-footnote",s.staticBibClass="abt-static-bib",e.default=s},400:function(t,e,n){"use strict";function r(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var l=function(){function t(t,e){var n=[],r=!0,o=!1,i=void 0;try{for(var a,l=t[Symbol.iterator]();!(r=(a=l.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{!r&&l.return&&l.return()}finally{if(o)throw i}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),c=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=function(t,e,n,r){return new(n||(n=Promise))(function(o,i){function a(t){try{c(r.next(t))}catch(t){i(t)}}function l(t){try{c(r.throw(t))}catch(t){i(t)}}function c(t){t.done?o(t.value):new n(function(e){e(t.value)}).then(a,l)}c((r=r.apply(t,e||[])).next())})};Object.defineProperty(e,"__esModule",{value:!0});var u=n(368),d=function(t){function e(){o(this,e);var t=i(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments));return t.editorCitationObserver=new MutationObserver(function(t){var e=!0,n=!1,r=void 0;try{for(var o,i=t[Symbol.iterator]();!(e=(o=i.next()).done);e=!0){var a=o.value,l=!0,c=!1,s=void 0;try{for(var d,f=Array.from(a.removedNodes)[Symbol.iterator]();!(l=(d=f.next()).done);l=!0){var h=d.value;if("SPAN"===h.nodeName){var y=h.attributes.getNamedItem("class");y&&y.value.split(" ").includes(u.default.citationClass)&&dispatchEvent(new CustomEvent(u.default.events.CITATION_DELETED))}}}catch(t){c=!0,s=t}finally{try{!l&&f.return&&f.return()}finally{if(c)throw s}}}}catch(t){n=!0,r=t}finally{try{!e&&i.return&&i.return()}finally{if(n)throw r}}}),t.selectionCache={fresh:!1,selection:"",bookmark:{rng:document.createRange()}},t}return a(e,t),c(e,[{key:"alert",value:function(t){this.editor.windowManager.alert(t)}},{key:"composeCitations",value:function(t,e,n){this.editor.focus();var r=this.editor.getDoc(),o=r.querySelectorAll("\n            #"+u.default.footnoteId+",\n            #"+u.default.bibliographyId+"\n        "),i=!0,a=!1,c=void 0;try{for(var s,d=Array.from(o)[Symbol.iterator]();!(i=(s=d.next()).done);i=!0){var f=s.value;f.parentElement&&f.parentElement.removeChild(f)}}catch(t){a=!0,c=t}finally{try{!i&&d.return&&d.return()}finally{if(a)throw c}}var h=!0,y=!1,v=void 0;try{for(var p,b=t[Symbol.iterator]();!(h=(p=b.next()).done);h=!0){var m=p.value,g=l(m,3),E=g[0],C=g[1],w=g[2],I=r.getElementById(w),_="note"===n?"["+(E+1)+"]":C,A=JSON.stringify(e[E].citationItems.map(function(t){return t.id}));I?(I.innerHTML=_,I.dataset.reflist=A,I.dataset.footnote="note"===n?C:void 0):this.editor.insertContent(u.default.createInlineElement({classNames:["noselect","mceNonEditable"],footnote:"note"===n?C:void 0,id:w,innerHTML:_,kind:n,reflist:A}).outerHTML)}}catch(t){y=!0,v=t}finally{try{!h&&b.return&&b.return()}finally{if(y)throw v}}return"note"===n?this.composeFootnotes():void 0}},{key:"init",value:function(){return s(this,void 0,void 0,regeneratorRuntime.mark(function t(){var e=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise(function(t,n){var r=0,o=setInterval(function(){if(void 0===top.tinyMCE){if(10===(r+=1))return clearInterval(o),n(new Error("TinyMCE editor doesn't appear to be available in this scope"))}else{if(clearInterval(o),top.tinyMCE.editors&&top.tinyMCE.editors.content&&top.tinyMCE.editors.content.initialized)return e.editor=top.tinyMCE.editors.content,e.bindEvents(),t();o=setInterval(function(){if(top.tinyMCE.editors.content&&top.tinyMCE.editors.content.initialized)return clearInterval(o),e.editor=top.tinyMCE.editors.content,e.bindEvents(),t()},200)}},500)}));case 1:case"end":return t.stop()}},t,this)}))}},{key:"removeItems",value:function(t){var e=this.editor.getDoc(),n=!0,r=!1,o=void 0;try{for(var i,a=t[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var l=i.value,c=e.getElementById(l);c&&c.parentElement&&c.parentElement.removeChild(c)}}catch(t){r=!0,o=t}finally{try{!n&&a.return&&a.return()}finally{if(r)throw o}}}},{key:"reset",value:function(){var t=this.editor.getDoc().querySelectorAll("#"+u.default.bibliographyId+", ."+u.default.citationClass),e=!0,n=!1,r=void 0;try{for(var o,i=Array.from(t)[Symbol.iterator]();!(e=(o=i.next()).done);e=!0){var a=o.value;a.parentElement&&a.parentElement.removeChild(a)}}catch(t){n=!0,r=t}finally{try{!e&&i.return&&i.return()}finally{if(n)throw r}}this.editor.insertContent("")}},{key:"setBibliography",value:function(t,e){return arguments.length>2&&void 0!==arguments[2]&&arguments[2]?this.setStaticBibliography(e):this.setStandardBibliography(t,e)}},{key:"setLoadingState",value:function(t){this.editor.setProgressState(t||!1)}},{key:"bindEvents",value:function(){var t=this;this.editor.on("focusin",function(){t.selectionCache=Object.assign({},t.selectionCache,{fresh:!1})}),this.editor.on("focusout",function(){t.selectionCache={fresh:!0,selection:t.selection,bookmark:t.editor.selection.getBookmark(1)}}),this.editor.on("hide",function(){dispatchEvent(new CustomEvent(u.default.events.UNAVAILABLE))}),this.editor.on("show",function(){dispatchEvent(new CustomEvent(u.default.events.AVAILABLE))}),this.editor.on("Undo",function(){dispatchEvent(new CustomEvent(u.default.events.UNDO))}),this.editor.addShortcut("meta+alt+r","Add Reference",function(){return dispatchEvent(new CustomEvent(u.default.events.ADD_REFERENCE))}),this.editor.addShortcut("meta+alt+p","Pin Reference List",function(){return dispatchEvent(new CustomEvent(u.default.events.TOGGLE_PINNED))}),this.editorCitationObserver.observe(this.editor.getBody(),{childList:!0,subtree:!0})}},{key:"composeFootnotes",value:function(){var t=this.editor.getDoc(),e=[].concat(r(t.querySelectorAll("."+u.default.citationClass).entries())).reduce(function(t,e){var n=l(e,2),o=n[0],i=n[1];i.innerHTML="["+(o+1)+"]";var a=i.getAttribute("data-footnote");return a?[].concat(r(t),[a]):t},[]);if(0!==e.length){var n=this.editor.selection.getBookmark(),o=u.default.createFootnoteSection(e,["noselect","mceNonEditable"]),i=this.editor.getBody();this.editor.selection.setCursorLocation(i,i.childNodes.length),this.editor.insertContent(o.outerHTML),this.editor.selection.moveToBookmark(n)}}},{key:"setStandardBibliography",value:function(t,e){if("boolean"!=typeof e&&0!==e.length){var n=u.default.createBibliographyElement(t,e,["noselect","mceNonEditable"]),r=this.editor.selection.getBookmark(),o=this.editor.getBody();this.editor.selection.setCursorLocation(o,o.childNodes.length),this.editor.insertContent(n.outerHTML),this.editor.selection.moveToBookmark(r)}}},{key:"setStaticBibliography",value:function(t){var e="boolean"==typeof t?[]:t,n=u.default.createBibliographyElement({},e,[""+u.default.staticBibClass,"noselect","mceNonEditable"]);this.selectionCache.fresh&&this.editor.selection.moveToBookmark(this.selectionCache.bookmark),this.editor.insertContent(n.outerHTML)}},{key:"citationIds",get:function(){return[].concat(r(this.editor.getDoc().querySelectorAll("*:not(.mce-offscreen-selection) > ."+u.default.citationClass))).map(function(t){return t.id})}},{key:"citationsByIndex",get:function(){var t=this.editor.getDoc(),e=[].concat(r(t.querySelectorAll("\n                *:not(.mce-offscreen-selection) >\n                    ."+u.default.citationClass+"\n            "))),n=null!==t.querySelector("#"+u.default.footnoteId);return e.reduce(function(t,e,o){var i=e.getAttribute("data-reflist");if(!i)return t;var a=JSON.parse(i);return[].concat(r(t),[{citationID:e.id,citationItems:a.map(function(t){return{id:t}}),properties:{index:o,noteIndex:n?1:0}}])},[])}},{key:"relativeCitationPositions",get:function(){var t=this,e=this.editor.getDoc(),n=this.selectionCache.fresh?this.selectionCache.bookmark:this.editor.selection.getBookmark(1),o=n.rng.startContainer;return[].concat(r(e.querySelectorAll("\n                *:not(.mce-offscreen-selection) >\n                    ."+u.default.citationClass+"\n            "))).reduce(function(e,n,i){if(!n.parentNode)throw new Error("parentNode not defined for citation");switch(o.compareDocumentPosition(n)){case Node.DOCUMENT_POSITION_PRECEDING:e.itemsPreceding=[].concat(r(e.itemsPreceding),[[n.id,i]]);break;case Node.DOCUMENT_POSITION_FOLLOWING:e.itemsFollowing=[].concat(r(e.itemsFollowing),[[n.id,i+1]]);break;default:n.parentElement.removeChild(n),t.editor.selection.moveToBookmark(t.selectionCache.bookmark)}return e},{itemsPreceding:[],itemsFollowing:[]})}},{key:"selection",get:function(){return this.selectionCache.fresh?this.selectionCache.selection:this.editor.selection.getContent({format:"html"})}}]),e}(u.default);e.default=d},648:function(t,e,n){t.exports=n(400)}});
//# sourceMappingURL=tinymce.js.map